# netty

学习netty之前应该先知道netty为什么出现，解决了哪些问题?

Netty 是一款用于高效开发网络应用的 NIO 网络框架，它大大简化了网络应用的开发过程

一个网络框架，核心点应该在于以下几个方面：

● I/O 模型、线程模型和事件处理机制；

● 易用性 API 接口；

● 对数据协议、序列化的支持。

以下将对IO模型，线程模型，事件处理机制，易用性API接口，对数据协议，序列化支持进行分析

## I/O模型

### 什么是IO？

说起IO模型，应该先直到什么是IO？

IO即input/output的缩写，input(输入)，output(输出)是针对于内存来说的
IO可以从多方面看

如果从计算机分类来看，input代表鼠标，键盘等输入设备，output代表显示器

如果从应用程序来看，input代表从磁盘网卡等硬件设备获取数据到内存，output则相反代表从内存到磁盘网卡等设备

## IO过程
前置知识：CPU指令集是CPU实现软件控制硬件的媒介，具体来说每一条汇编语句都代表了一条CPU指令。同时CPU指令集是分等级权限的，如果不分，所有的软件都可以调用所有指令集，那操作系统的出错率将极高，所以CPU指令集可以看成分为两类：

● 内核态：可IO读写，网卡访问，申请内存

● 用户态：代码没有操作硬件的权限，也不能直接访问内存地址，通过系统调用的方式来达到访问硬件和内存

所以一次完整的IO应该包含应用程序向操作系统发起IO调用，操作系统完成IO执行

整个流程为，应用程序发起IO调用，操作系统将数据从网卡复制到内核缓冲区后，再将缓冲区内的数据复制到应用程序的用户缓冲区，然后返回IO调用，告诉应用程序数据已准备好，应用程序就可以操作数据了。

思考：为什么需要内核缓冲区？而不是直接从网卡复制到应用程序空间？

因为我们在生成缓冲区的时候都是随意的,比如byte[128],byte[1024],可以随意指定，但是从磁盘读取数据时都不是读取任意大小的数据，而是读一个磁盘块或者多个(因为访问磁盘的代价是非常大的),因此就需要有一个中间缓冲区先把数据从磁盘读到中间缓冲区（随机IO，顺序IO），然后再把数据从中间缓冲区复制到用户缓冲区。这个中间缓冲区即是内核缓冲区。